<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:websocket="http://www.springframework.org/schema/websocket"
	xsi:schemaLocation="http://www.springframework.org/schema/websocket http://www.springframework.org/schema/websocket/spring-websocket-4.3.xsd
		http://www.springframework.org/schema/mvc https://www.springframework.org/schema/mvc/spring-mvc.xsd
		http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd">

	<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->
	
	<!-- Enables the Spring MVC @Controller programming model -->
	<annotation-driven />

	<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
	<resources mapping="/resources/**" location="/resources/" />

	<!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
	<beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
		<beans:property name="prefix" value="/WEB-INF/views/" />
		<beans:property name="suffix" value=".jsp" />
	</beans:bean>
	
	<!-- 인터셉터 등록 : 어떠한 요청에 어떠한 인터셉터를 동작시킬것인지 등록하기 -->
		<!-- 참고용 예시 -->
		<!-- /* : 첫번째 레벨 전체 요청 , /** : 추가레벨까지 전체 요청 -->
		<!-- <mapping path="/*.me"/> --> <!-- .me로 끝나는 모든 요청에 대해서 처리 -->
	<interceptors>
		<!-- 로그인 해야 접근 가능한 페이지 -->
		<interceptor>
			<!-- 적용할 매핑 주소 <mapping path=""/> -->
			<mapping path="/adoption.enrollpageanimal"/>
			<mapping path="/adoption.applicationpage"/>
			<mapping path="/adoption.updateanimal"/>
			<mapping path="/adoption.deleteanimal"/>
			<mapping path="/adoption.acceptadoptionapp"/>
			<mapping path="/adoption.denyadoptionapp"/>
			<mapping path="/adoption.applicants"/>
			<mapping path="/adoption.confirm"/>
			<mapping path="/adoption.insert.board"/>
			<mapping path="/adoption.insert.board.direct"/>
			<mapping path="/adoption.insert.animal"/>
			<mapping path="/adoption.deleteadoptionapp"/>
			<mapping path="/adoption.update.animal.action"/>
			<mapping path="/adoption.insertapplication"/>
			<mapping path="/adoption.enrollpagepost"/>
			<mapping path="/adoption.mypage"/>
			<mapping path="/adoption.deny.board.direct"/>
			<!-- Dong : /message, /kick 모든 주소, /user 일부 주소 로그인 시에만 접근 가능하게 -->
			<mapping path="/message"/>
			<mapping path="/message/**"/>
			<mapping path="/kick"/>
			<mapping path="/kick/**"/>
			<mapping path="/user/mypage.me"/>
			<mapping path="/user/update.me"/>
			<mapping path="/user/delete.me"/>
			<!-- Jae -->
			<mapping path="/donation"/>
			<mapping path="/donation/**"/>
			<mapping path="/funding"/>
			<mapping path="/funding/**"/>
			<!-- chan -->
			<mapping path="/volunteerDetail.vo"/>
			<mapping path="/volunteerSign.vo"/>
			<mapping path="/reviewDetail.vo"/>
			<mapping path="/reviewInsertReply.vo"/>
			<mapping path="/deleteReply.vo"/>
			<mapping path="/updateSignStatusUser.vo"/>
			
			<!-- 제외하고싶은 매핑 주소 <exclude-mapping path=""/> -->
			<beans:bean class="com.ubig.app.common.interceptor.LoginInterceptor"/>
		</interceptor>
		<!-- 관리자만 접근 가능한 페이지 -->
		<interceptor>
			<!-- 적용할 매핑 주소 <mapping path=""/> -->
			<mapping path="/adoption.postmanage"/>
			<mapping path="/adoption.deny.board.direct"/>
			<!-- Dong : /admin 모든 주소 관리자만 접근 가능하게 -->
			<mapping path="/admin/**"/>
			<mapping path="/admin"/>
			<!-- chan -->
			<mapping path="/volunteerWriteForm.vo"/>
			<mapping path="/volunteerInsert.vo"/>
			<mapping path="/volunteerUpdateForm.vo"/>
			<mapping path="/volunteerUpdate.vo"/>
			<mapping path="/volunteerDelete.vo"/>
			<mapping path="/signList.vo"/>
			<mapping path="/updateSignStatusAdmin.vo"/>
			<mapping path="/reviewWriteForm.vo"/>
			<mapping path="/insertReview.vo"/>
			<mapping path="/reviewUpdateForm.vo"/>
			<mapping path="/updateReview.vo"/>
			<mapping path="/deleteReview.vo"/>
			<!-- jae -->
			<mapping path="/funding/insertPage"/>						
			<!-- 제외하고싶은 매핑 주소 <exclude-mapping path=""/> -->
			<beans:bean class="com.ubig.app.common.interceptor.AdminInterceptor"/>
		</interceptor>
	</interceptors>
	
	<!-- 웹소켓 서버 등록 -->
	<beans:bean class="com.ubig.app.member.server.ChatServer" id="chatServer"></beans:bean>
	<websocket:handlers>
		<websocket:mapping handler="chatServer" path="/chat"/>
		
		<websocket:handshake-interceptors>
			<beans:bean class="org.springframework.web.socket.server.support.HttpSessionHandshakeInterceptor"/>
		</websocket:handshake-interceptors>
	</websocket:handlers>
	
	
	<!-- 파일 업로드 처리용 MultipartResolver 등록하기 -->
	<beans:bean class="org.springframework.web.multipart.commons.CommonsMultipartResolver" id="multipartResolver">
		<!-- 업로드되는 파일의 인코딩 설정 -->
		<beans:property name="defaultEncoding" value="UTF-8"></beans:property>
		<!-- 용량 제한 : 100MB 정도로 설정 (100 * 1024 * 1024). 계산식이 적용되지 않기 때문에 직접 계산한 값을 넣어주기 -->
		<beans:property name="maxInMemorySize" value="100000000"></beans:property> <!-- 임시 메모리 보관 크기 -->
		<beans:property name="maxUploadSize" value="100000000"></beans:property> <!-- 업로드 파일 용량 크기 -->
	</beans:bean>
	
	<!-- root-context에서 등록한 컴포넌트 제외하기 -->
	<context:component-scan base-package="com.ubig.app">
	 	<context:exclude-filter type="annotation" expression="org.springframework.stereotype.Service"/>
	 	<context:exclude-filter type="annotation" expression="org.springframework.stereotype.Repository"/>
	 	<context:exclude-filter type="annotation" expression="org.aspectj.lang.annotation.Aspect"/>
	</context:component-scan>
	
	
	
</beans:beans>
